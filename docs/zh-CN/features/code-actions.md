import Image from '@site/src/components/Image';

# 代码操作

代码操作是 VS Code 的一项强大功能，它可以直接在编辑器中提供快速修复、重构和其他代码相关建议。Kilo Code 与这一系统集成，为常见的编码任务提供 AI 驱动的辅助。

## 什么是代码操作？

代码操作以灯泡图标（💡）的形式出现在编辑器左侧的装订线（行号左侧的区域）中。它们也可以通过右键菜单或键盘快捷键访问。触发代码操作的情况包括：

*   你选择了一段代码。
*   你的光标位于有问题的行（错误、警告或提示）。
*   你通过命令调用它们。

点击灯泡、右键选择“Kilo Code”或使用键盘快捷键（默认情况下，Windows/Linux 为 `Ctrl+.`，macOS 为 `Cmd+.`），会显示可用操作的菜单。

<Image src="/docs/img/code-actions/code-actions-1.png" alt="VS Code 代码操作" width="500" />

## Kilo Code 的代码操作

Kilo Code 提供以下代码操作：

*   **添加上下文：** 快速将选中的代码添加到与 Kilo 的聊天中，包括行号以便 Kilo 知道代码的确切位置。它位于菜单顶部以便快速访问。（详见下文）。
*   **解释代码：** 让 Kilo Code 解释选中的代码。
*   **修复代码：** 让 Kilo Code 修复选中代码中的问题（当存在诊断信息时可用）。
*   **改进代码：** 让 Kilo Code 建议对选中代码的改进。

### 添加上下文深入解析

**添加上下文** 操作位于代码操作菜单的顶部，以便你可以快速将代码片段添加到对话中。当你使用它时，Kilo Code 会包含文件名和行号以及代码。

这有助于 Kilo 理解代码在项目中的确切上下文，从而提供更相关和准确的帮助。

<Image src="/docs/img/code-actions/add-to-context.gif" alt="代码操作 - 添加上下文" width="80%" />

**示例聊天输入：**

```
你能解释这个函数吗？
@myFile.js:15:25
```

*(其中 `@myFile.js:15:25` 表示通过“添加上下文”添加的代码)*

每个操作都可以在“新任务”或“当前任务”中执行。

## 使用代码操作

使用 Kilo Code 代码操作的主要方式有三种：

### 1. 通过灯泡图标（💡）

1.  **选择代码：** 选择你要处理的代码。你可以选择单行、多行或整个代码块。
2.  **寻找灯泡：** 灯泡图标会出现在选中代码（或有错误/警告的行）旁边的装订线中。
3.  **点击灯泡：** 点击灯泡图标以打开代码操作菜单。
4.  **选择一个操作：** 从菜单中选择所需的 Kilo Code 操作。
5.  **审查并批准：** Kilo Code 会在聊天面板中提出解决方案。审查提出的更改并批准或拒绝它们。

### 2. 通过右键菜单

1.  **选择代码：** 选择你要处理的代码。
2.  **右键点击：** 右键点击选中的代码以打开上下文菜单。
3.  **选择“Kilo Code”：** 从上下文菜单中选择“Kilo Code”选项。将出现一个子菜单，显示可用的 Kilo Code 操作。
4.  **选择一个操作：** 从子菜单中选择所需的操作。
5.  **审查并批准：** Kilo Code 会在聊天面板中提出解决方案。审查提出的更改并批准或拒绝它们。

### 3. 通过命令面板

1.  **选择代码：** 选择你要处理的代码。
2.  **打开命令面板：** 按 `Ctrl+Shift+P`（Windows/Linux）或 `Cmd+Shift+P`（macOS）。
3.  **输入命令：** 输入“Kilo Code”以过滤命令，然后选择相关的代码操作（例如，“Kilo Code: 解释代码”）。你也可以输入命令的开头，如“Kilo Code: 解释”，并从过滤列表中选择。
4.  **审查并批准：** Kilo Code 会在聊天面板中提出解决方案。审查提出的更改并批准或拒绝它们。

## 代码操作与当前任务

每个代码操作都提供两个选项：

*   **在新任务中：** 选择此项以开始一个围绕此代码操作的对话。
*   **在当前任务中：** 如果对话已经开始，此选项将代码操作作为附加消息添加到当前对话中。

## 自定义代码操作提示

你可以通过修改**提示**选项卡中的“支持提示”来自定义每个代码操作的提示。这允许你微调给 AI 模型的指令，并根据你的具体需求定制响应。

1.  **打开提示选项卡：** 点击 Kilo Code 顶部菜单栏中的 <Codicon name="notebook" /> 图标。
2. **找到“支持提示”：** 你会看到支持提示，包括“增强提示”、“解释代码”、“修复代码”和“改进代码”。
3. **编辑提示：** 修改你要自定义的提示的文本区域。你可以使用占位符，如 `${filePath}` 和 `${selectedText}` 来包含当前文件和选择的信息。
4. **点击“完成”：** 保存你的更改。

通过使用 Kilo Code 的代码操作，你可以直接在编码工作流程中快速获得 AI 驱动的辅助。这可以节省时间并帮助你编写更好的代码。